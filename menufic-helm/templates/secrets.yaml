apiVersion: v1                                                                                                                                                                
kind: Secret                                                                                                                                                                  
metadata:                                                                                                                                                                     
  name: {{ printf "%s-%s" .Release.Name .Chart.Name }}-secret-env                                                                                                             
type: Opaque                                                                                                                                                                  
data:                                                                                                                                                                         
  GITHUB_CLIENT_SECRET: {{ .Values.github.secret | b64enc }}                                                                                                                  
  GOOGLE_CLIENT_SECRET: {{ .Values.google.secret | b64enc }}                                                                                                                  
  IMAGEKIT_PRIVATE_KEY: {{ .Values.imagekit.privateKey | b64enc }}                                                                                                            
  NEXTAUTH_SECRET: {{ .Values.nextauth.secret | b64enc }}                                                                                                                     
  SENTRY_AUTH_TOKEN: {{ .Values.sentry.authToken | b64enc }}
  {{- if .Values.mariadb.enabled }}
  DATABASE_URL: {{ printf "mysql://%s:%s@%s-mariadb:3306/%s" .Values.mariadb.auth.username .Values.mariadb.auth.password .Release.Name .Values.mariadb.auth.database | b64enc }}    
  {{- else }}
  DATABASE_URL: {{ printf "mysql://%s:%s@%s:%d/%s" .Values.externalDatabase.user .Values.externalDatabase.password .Values.externalDatabase.host (.Values.externalDatabase.port | int) .Values.externalDatabase.database | b64enc }}
  {{- end }}
